<?xml version="1.0" encoding="UTF-8"?>

<deployment xmlns="urn:jboss:bean-deployer:2.0">

  <!-- The registry for web service endpoints -->
  <bean name="WSEndpointRegistry" class="org.jboss.wsf.framework.management.ManagedEndpointRegistry">
    <property name="mbeanServer"><inject bean="WSMBeanServerLocator" property="mbeanServer"/></property>
  </bean>

  <!-- A subscription manager for WS-Eventing -->
  <bean name="WSSubscriptionManager" class="org.jboss.ws.extensions.eventing.mgmt.SubscriptionManager">
    <property name="bindAddress">${jboss.bind.address}</property>
  </bean>

  <!-- Installed Record Processors-->
  <bean name="WSMemoryBufferRecorder" class="org.jboss.wsf.framework.management.recording.MemoryBufferRecorder">
    <property name="recording">false</property>
  </bean>
  <bean name="WSLogRecorder" class="org.jboss.wsf.framework.management.recording.LogRecorder">
    <property name="recording">false</property>
  </bean>

  <!-- The stack specific deployment aspects wrapped in deployers -->
  <bean name="WSNativeContextPropertiesDeploymentAspect" class="org.jboss.wsf.framework.deployment.ContextPropertiesDeploymentAspect">
    <property name="provides">ContextProperties, StackDescriptor, StackSpecificMetaData</property>
    <property name="contextProperties">
      <map keyClass="java.lang.String" valueClass="java.lang.String">
        <entry><key>org.jboss.ws.webapp.ServletClass</key><value>org.jboss.wsf.stack.jbws.EndpointServlet</value></entry>
      </map>
    </property>
  </bean>

  <bean name="WSNativeContextPropertiesDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativeContextPropertiesDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">31</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSNativeEagerInitializeDeploymentAspect" class="org.jboss.wsf.stack.jbws.EagerInitializeDeploymentAspect">
    <property name="requires">UnifiedMetaDataModel</property>
    <property name="provides">InitializedMetaDataModel, StackSpecificMetaData</property>
  </bean>

  <bean name="WSNativeEagerInitializeDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativeEagerInitializeDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">25</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSNativeEndpointHandlerDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointHandlerDeploymentAspect">
    <property name="requires">ContainerMetaData</property>
    <property name="provides">StackEndpointHandler, StackSpecificMetaData</property>
  </bean>

  <bean name="WSNativeEndpointHandlerDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativeEndpointHandlerDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">13</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSNativeEndpointRecordProcessorDeploymentAspect" class="org.jboss.wsf.framework.deployment.EndpointRecordProcessorDeploymentAspect">
    <property name="mbeanServer"><inject bean="WSMBeanServerLocator" property="mbeanServer"/></property>
    <property name="requires">RegisteredEndpoint</property>
    <property name="provides">EndpointRecordProcessors, StackSpecificMetaData</property>
    <property name="processors">
      <list class="java.util.ArrayList" elementClass="org.jboss.wsf.spi.management.recording.RecordProcessor">
        <inject bean="WSMemoryBufferRecorder"/>
        <inject bean="WSLogRecorder"/>
      </list>
    </property>
  </bean>

  <bean name="WSNativeEndpointRecordProcessorDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativeEndpointRecordProcessorDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">36</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSNativeEventingDeploymentAspect" class="org.jboss.wsf.stack.jbws.EventingDeploymentAspect">
    <property name="requires">UnifiedMetaDataModel</property>
    <property name="provides">StackSpecificMetaData</property>
  </bean>

  <bean name="WSNativeEventingDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativeEventingDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">26</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSNativePublishContractDeploymentAspect" class="org.jboss.wsf.stack.jbws.PublishContractDeploymentAspect">
    <property name="requires">UnifiedMetaDataModel, JAXBIntros</property>
    <property name="provides">PublishedContract, StackSpecificMetaData</property>
  </bean>

  <bean name="WSNativePublishContractDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativePublishContractDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">24</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSNativeServiceEndpointInvokerDeploymentAspect" class="org.jboss.wsf.stack.jbws.ServiceEndpointInvokerDeploymentAspect">
    <property name="requires">UnifiedMetaDataModel</property>
    <property name="provides">StackSpecificMetaData</property>
  </bean>

  <bean name="WSNativeServiceEndpointInvokerDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativeServiceEndpointInvokerDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">23</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSNativeRMDeploymentAspect" class="org.jboss.ws.extensions.wsrm.server.RMDeploymentAspect">
    <property name="requires">StackEndpointHandler, UnifiedMetaDataModel</property>
    <property name="provides">StackSpecificMetaData</property>
  </bean>

  <bean name="WSNativeRMDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativeRMDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">27</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSNativeUnifiedMetaDataDeploymentAspect" class="org.jboss.wsf.stack.jbws.UnifiedMetaDataDeploymentAspect">
    <property name="requires">RuntimeLoader, ContainerMetaData, URLPattern, VFSRoot, JAXBIntros</property>
    <property name="provides">UnifiedMetaDataModel, StackSpecificMetaData</property>
  </bean>

  <bean name="WSNativeUnifiedMetaDataDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSNativeUnifiedMetaDataDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">22</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

  <bean name="WSJAXBIntroDeploymentAspect" class="org.jboss.wsf.stack.jbws.JAXBIntroDeploymentAspect">
    <property name="provides">JAXBIntros, StackSpecificMetaData</property>
  </bean>

  <bean name="WSJAXBIntroDeployer" class="org.jboss.wsf.container.jboss50.deployer.WSDeploymentAspectDeployer">
    <constructor>
      <parameter>
        <inject bean="WSJAXBIntroDeploymentAspect"/>
      </parameter>
    </constructor>
    <property name="relativeOrder">21</property> <!-- [JBDEPLOY-201] workaround -->
  </bean>

</deployment>
